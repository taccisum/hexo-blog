---
title: 项目开发环境搭建流程
date: 2018-03-06 15:00:00
categories:
    - 
tags:
---

# 基本步骤

## 克隆后台开发代码模板
从服务器上搭建的[gitlab](http://172.10.10.66:8082/)中克隆项目模板。
url: [http://172.10.10.66:8082/template/java-back-end.git](http://172.10.10.66:8082/template/java-back-end)

```shell
$ git clone http://172.10.10.66:8082/template/java-back-end.git
```

然后使用IDEA打开项目。

## 导入依赖包
1. 修改IDEA使用的maven配置文件（[参考](http://172.10.10.66:8082/shared/configuration-files/blob/master/maven/settings/dev/settings.xml)），使用公司内部搭建的[maven私服](http://172.10.10.66:8081/nexus)
2. reimport导入依赖

## 复制微信支付证书到本地，并在项目中指定其路径
1. 将证书复制一份到本地任意路径（出于安全考虑，证书不会上传到git仓库中）
2. 在yml文件中修改，指定证书路径，支持`绝对路径`及`classpath相对路径`

**注：**
- 证书在工程中存放的路径默认为`classpath:asset/cert`，这个目录下的所有文件是被.gitignore指定忽略掉的
- 不执行这一步操作也不会影响项目运行，但是会**导致微信支付的某些功能无法使用**

## 修改项目内容
1. 使用IDEA功能重命名模块（shift + F6）
2. 使用全局搜索功能替换全部为『be-』开头的文本（ctrl + shift + r）
3. 重命名`BEProviderApplication`和`BEErrorCode`**注：一定要使用ide的重构功能，确保类引用同步修改**
4. 编译工程，确保之前的改动没有出现错误

**注：**
- be即back-end的缩写

## 启动项目
1. 执行spring boot应用。如果端口冲突，请修改配置`server.port`
2. 打开swagger页面（/swagger-ui.html），查看效果

## 将项目导入新的repo
1. 在gitlab中创建一个新的repo，用来存放我们copy后修改过的项目
2. 将本地的git仓库清除，重新初始化，并关联刚创建好的repo作为该项目的远程仓库
3. 提交代码到远程仓库
4. 之后别的同事就可以从这个仓库克隆项目下来，进行协作开发了

先切换当前目录到项目根目录，然后执行以下命令，其中{remote-repo-url}是你刚创建的远程仓库地址
```shell
rm -rf .git
git init
git add .
git commit -m "new project"
git remote add origin {remote-repo-url}
git push origin master
```

# 项目结构说明

典型的项目共分为4个模块：core/provider/client/job

## core
项目的核心，为其它模块的公共依赖。必需。

## provider
服务提供者，一般部署的是这个模块。主要是提供对前端开放的http服务。必需。

## client
sdk，对应provider中的接口。一般会打包发布到公司的[maven私服](http://172.10.10.66:8081/nexus/)，供其它java应用程序依赖使用。非必需。

## job
编写一些定时任务，需要单独部署。非必需。


# 其它注意事项

## 第三方支付sdk的问题
目前（2018-03-06），项目中依赖的`支付宝`和`微信`的`官方sdk`无法在中央仓库中下载，所以我将这些sdk手动导入到了我们的maven私服中，让我们可以通过maven配置依赖的方式直接使用它们。
也因此，**如果哪天重新部署了maven私服，这些包是需要重新导入的**，否则会导致我们的项目依赖缺失，无法正常运行。

其它sdk倒没有这个问题，如`paypal`，`七牛云`，都能直接从中央仓库下载。

